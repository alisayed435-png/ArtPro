import{c as _,aD as w,r as v,j as e,B as f,E as C,p as x,e as h,f as u,d as F,n,aE as M,g as D,h as I,i as q,G as B,H,J as U,K as V,M as o,T as z,U as K,V as S,W as g,Y as Q,O,Q as Y,x as E,Z as p,t as G}from"./index-DIym6ZJh.js";import{u as T,P as k,E as J,T as W,C as X}from"./error-state-Cz1jCqiM.js";import{E as Z}from"./empty-state-BgSyiygK.js";import{P as $}from"./package-BIGHHR3q.js";import{F as ee}from"./file-text-DMkqV9F7.js";import{C as ae}from"./circle-x-CNE56vUs.js";import{C as se}from"./circle-check-Dv1yTfX-.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=_("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);function re(){return T({queryKey:["compliance","status"],queryFn:w.getStatus,refetchInterval:3e4})}function le(a=1,r=20){return T({queryKey:["compliance","events",a,r],queryFn:()=>w.getEvents({page:a})})}function j({title:a,description:r,status:i,lastSync:d,icon:m}){const l={synced:{color:"text-green-600 dark:text-green-400",bg:"bg-green-100 dark:bg-green-900/30",label:"Synced",icon:se},syncing:{color:"text-blue-600 dark:text-blue-400",bg:"bg-blue-100 dark:bg-blue-900/30",label:"Syncing",icon:C},error:{color:"text-red-600 dark:text-red-400",bg:"bg-red-100 dark:bg-red-900/30",label:"Error",icon:ae},pending:{color:"text-yellow-600 dark:text-yellow-400",bg:"bg-yellow-100 dark:bg-yellow-900/30",label:"Pending",icon:X}}[i],b=l.icon;return e.jsx(h,{children:e.jsxs(u,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:x("p-2 rounded-lg",l.bg),children:e.jsx(m,{className:x("h-5 w-5",l.color)})}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(b,{className:x("h-4 w-4",l.color,i==="syncing"&&"animate-spin")}),e.jsx("span",{className:x("text-sm font-medium",l.color),children:l.label})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold",children:a}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:r})]}),d&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:["Last synced: ",E(d)]})]})})}function ne({event:a}){const r={package_created:{color:"text-blue-700 dark:text-blue-300",bg:"bg-blue-100 dark:bg-blue-900/30",label:"Package Created"},package_updated:{color:"text-blue-700 dark:text-blue-300",bg:"bg-blue-100 dark:bg-blue-900/30",label:"Package Updated"},transfer_initiated:{color:"text-purple-700 dark:text-purple-300",bg:"bg-purple-100 dark:bg-purple-900/30",label:"Transfer Started"},transfer_completed:{color:"text-green-700 dark:text-green-300",bg:"bg-green-100 dark:bg-green-900/30",label:"Transfer Done"},sync_started:{color:"text-yellow-700 dark:text-yellow-300",bg:"bg-yellow-100 dark:bg-yellow-900/30",label:"Sync Started"},sync_completed:{color:"text-green-700 dark:text-green-300",bg:"bg-green-100 dark:bg-green-900/30",label:"Sync Done"},sync_failed:{color:"text-red-700 dark:text-red-300",bg:"bg-red-100 dark:bg-red-900/30",label:"Sync Failed"},manifest_generated:{color:"text-gray-700 dark:text-gray-300",bg:"bg-gray-100 dark:bg-gray-900/30",label:"Manifest"},license_renewal:{color:"text-orange-700 dark:text-orange-300",bg:"bg-orange-100 dark:bg-orange-900/30",label:"License"},audit_log:{color:"text-gray-700 dark:text-gray-300",bg:"bg-gray-100 dark:bg-gray-900/30",label:"Audit"}},i={info:{variant:"secondary"},warning:{variant:"warning"},error:{variant:"destructive"},success:{variant:"success"}},d=r[a.type],m=i[a.severity];return e.jsxs(S,{children:[e.jsx(p,{children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:x("px-2 py-0.5 rounded text-xs font-medium",d.bg,d.color),children:d.label})})}),e.jsx(p,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.message}),a.details&&e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:a.details})]})}),e.jsx(p,{children:a.metrcId&&e.jsx("code",{className:"text-xs bg-muted px-1.5 py-0.5 rounded",children:a.metrcId})}),e.jsx(p,{children:e.jsx(G,{variant:m.variant,className:"capitalize",children:a.resolved?"Resolved":a.severity})}),e.jsx(p,{className:"text-muted-foreground",children:E(a.timestamp)})]})}function ce(){return e.jsx("div",{className:"space-y-2",children:Array.from({length:5}).map((a,r)=>e.jsxs("div",{className:"flex items-center gap-4 p-4",children:[e.jsx(n,{className:"h-6 w-16"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(n,{className:"h-4 w-3/4"}),e.jsx(n,{className:"h-3 w-1/2"})]}),e.jsx(n,{className:"h-5 w-20"}),e.jsx(n,{className:"h-4 w-24"})]},r))})}function he(){const[a,r]=v.useState(1),[i,d]=v.useState("all"),m=15,{data:s,isLoading:l,isError:b,refetch:N}=re(),{data:t,isLoading:P,isError:R,refetch:A}=le(a,m),y=i==="all"?t==null?void 0:t.data:t==null?void 0:t.data.filter(c=>c.type===i);return b||R?e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{title:"Compliance",description:"METRC integration and regulatory compliance tracking"}),e.jsx(J,{title:"Failed to load compliance data",description:"There was an error loading compliance information. Please try again.",onRetry:()=>{N(),A()}})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{title:"Compliance",description:"METRC integration and regulatory compliance tracking",action:e.jsxs(f,{variant:"outline",onClick:()=>N(),children:[e.jsx(C,{className:x("mr-2 h-4 w-4",l&&"animate-spin")}),"Sync Now"]})}),e.jsx(h,{className:"border-emerald-200 dark:border-emerald-800 bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20",children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white dark:bg-gray-900 rounded-full shadow-sm",children:e.jsx(F,{className:"h-8 w-8 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Compliance Score"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your organization maintains excellent regulatory standing"})]})]}),e.jsxs("div",{className:"text-center sm:text-right",children:[e.jsx("div",{className:"text-4xl font-bold text-emerald-600",children:l?e.jsx(n,{className:"h-10 w-24 inline-block"}):`${s!=null&&s.connected?100-(s.errorCount||0):98}%`}),e.jsx("p",{className:"text-sm text-emerald-600 font-medium",children:"Excellent"})]})]})})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:l?Array.from({length:4}).map((c,L)=>e.jsx(h,{children:e.jsxs(u,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{className:"h-9 w-9 rounded-lg"}),e.jsx(n,{className:"h-5 w-16"})]}),e.jsx(n,{className:"h-5 w-3/4"}),e.jsx(n,{className:"h-4 w-full"})]})},L)):e.jsxs(e.Fragment,{children:[e.jsx(j,{title:"METRC API",description:"Cannabis tracking system integration",status:(s==null?void 0:s.syncStatus)==="success"?"synced":(s==null?void 0:s.syncStatus)==="error"?"error":"syncing",lastSync:s!=null&&s.lastSyncAt?new Date(s.lastSyncAt):new Date,icon:M}),e.jsx(j,{title:"Package Labels",description:"Label compliance verification",status:"synced",lastSync:new Date,icon:$}),e.jsx(j,{title:"Lab Results",description:"COA and test result sync",status:"synced",lastSync:new Date,icon:ee}),e.jsx(j,{title:"Manifests",description:"Transfer manifest generation",status:"synced",lastSync:new Date,icon:te})]})}),e.jsxs(h,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"Compliance Event Log"}),e.jsx(q,{children:"Real-time tracking of all compliance-related activities"})]}),e.jsxs(B,{value:i,onValueChange:d,children:[e.jsx(H,{className:"w-[160px]",children:e.jsx(U,{placeholder:"Filter by type"})}),e.jsxs(V,{children:[e.jsx(o,{value:"all",children:"All Events"}),e.jsx(o,{value:"sync",children:"Sync"}),e.jsx(o,{value:"submission",children:"Submission"}),e.jsx(o,{value:"validation",children:"Validation"}),e.jsx(o,{value:"approval",children:"Approval"}),e.jsx(o,{value:"rejection",children:"Rejection"}),e.jsx(o,{value:"update",children:"Update"})]})]})]})}),e.jsx(u,{children:P?e.jsx(ce,{}):!y||y.length===0?e.jsx(Z,{title:"No compliance events",description:"Compliance events will appear here as they occur."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(z,{children:[e.jsx(K,{children:e.jsxs(S,{children:[e.jsx(g,{className:"w-[100px]",children:"Type"}),e.jsx(g,{children:"Description"}),e.jsx(g,{className:"w-[140px]",children:"Reference"}),e.jsx(g,{className:"w-[100px]",children:"Status"}),e.jsx(g,{className:"w-[140px]",children:"Timestamp"})]})}),e.jsx(Q,{children:y.map(c=>e.jsx(ne,{event:c},c.id))})]})}),t&&t.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",t.page," of"," ",t.totalPages," (",t.total," ","events)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>r(c=>Math.max(1,c-1)),disabled:a===1,children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>r(c=>Math.min(t.totalPages,c+1)),disabled:a>=t.totalPages,children:["Next",e.jsx(Y,{className:"h-4 w-4 ml-1"})]})]})]})]})})]}),e.jsx(h,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(W,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100",children:"Compliance Best Practices"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:"Keep your METRC credentials up to date and ensure all packages are properly tagged before shipping. Regular audits help maintain your excellent compliance score."})]})]})})})]})}export{he as CompliancePage,le as useComplianceEventsQuery,re as useComplianceStatusQuery};
