import{c as y,y as T,p as f,z as g,j as e,A as v,B as d,X as _,D as $,E as H,F as u,G as x,H as D,d as h,h as S,J as G,I as U,K as W,M as Y,N as J,O as X,Q as k,T as Z,U as ee,V as se,W as ae,Y as te,Z as P,_ as o,$ as le,a0 as m,x as re,a1 as ie,a2 as ne,a3 as ce,a4 as N,v as de}from"./index-CUynBhN4.js";import{u as M,C as oe,P as O,E as me}from"./error-state-D0gg85C0.js";import{E as xe}from"./empty-state-C9lweCNL.js";import{S as F}from"./status-badge-Cr1DXjPn.js";import{u as I,P as he,E as ue,a as je,D as pe}from"./plus-D-Z6BmTQ.js";import{P as ge}from"./package-wPugkV3h.js";import{T as fe}from"./truck-DIJv_NN1.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=y("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=y("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=y("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);function be(s={}){return M({queryKey:["orders",s],queryFn:()=>f.getOrders(s),staleTime:3e4})}function Ae(s){return M({queryKey:["orders",s],queryFn:()=>f.getOrderById(s),enabled:!!s})}function A(){const s=T();return I({mutationFn:l=>f.reorder(l),onSuccess:()=>{s.invalidateQueries({queryKey:["orders"]}),g.success("Reorder created successfully",{description:"Your new order has been submitted."})},onError:()=>{g.error("Failed to create reorder",{description:"Please try again."})}})}function Ee(){const s=T();return I({mutationFn:l=>f.cancelOrder(l),onSuccess:()=>{s.invalidateQueries({queryKey:["orders"]}),g.success("Order cancelled",{description:"The order has been cancelled successfully."})},onError:()=>{g.error("Failed to cancel order",{description:"Please try again."})}})}function we({order:s,open:l,onClose:c}){const r=A();if(!s)return null;const t=()=>{r.mutate(s.id),c()};return e.jsxs(e.Fragment,{children:[l&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50",onClick:c}),e.jsx("div",{className:`fixed inset-y-0 right-0 z-50 w-full max-w-lg bg-background border-l shadow-xl transform transition-transform duration-300 ${l?"translate-x-0":"translate-x-full"}`,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:s.orderNumber}),e.jsx(F,{status:s.status})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Created ",v(s.createdAt)]})]}),e.jsx(d,{variant:"ghost",size:"icon",onClick:c,children:e.jsx(_,{className:"h-5 w-5"})})]}),e.jsx($,{className:"flex-1",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-4 flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Order Timeline"]}),e.jsx("div",{className:"relative pl-6 space-y-4",children:s.timeline.map((a,j)=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -left-6 top-0.5 h-4 w-4 rounded-full bg-primary border-2 border-background"}),j<s.timeline.length-1&&e.jsx("div",{className:"absolute -left-[14px] top-5 h-full w-0.5 bg-border"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:a.description}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[H(a.timestamp),a.userName&&` • ${a.userName}`]})]})]},a.id))})]}),e.jsx(u,{}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-4 flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Line Items (",s.lineItems.length,")"]}),e.jsx("div",{className:"space-y-3",children:s.lineItems.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:a.productName}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["SKU: ",a.sku," • Qty: ",a.quantity.toLocaleString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:x(a.totalPrice)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[x(a.unitPrice),"/unit"]})]})]},a.id))})]}),e.jsx(u,{}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Shipping Address"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{children:s.shippingAddress.street1}),s.shippingAddress.street2&&e.jsx("p",{children:s.shippingAddress.street2}),e.jsxs("p",{children:[s.shippingAddress.city,", ",s.shippingAddress.state," ",s.shippingAddress.zipCode]})]})]}),s.estimatedDelivery&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Estimated Delivery"]}),e.jsx("p",{className:"text-sm",children:v(s.estimatedDelivery)})]})]}),e.jsx(u,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsx("span",{children:x(s.subtotal)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Tax"}),e.jsx("span",{children:x(s.tax)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Shipping"}),e.jsx("span",{children:s.shippingCost===0?"Free":x(s.shippingCost)})]}),e.jsx(u,{className:"my-2"}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:x(s.total)})]})]})]})]})}),e.jsx("div",{className:"p-6 border-t bg-muted/30",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(d,{variant:"outline",className:"flex-1",onClick:t,disabled:r.isPending,children:[e.jsx(D,{className:`mr-2 h-4 w-4 ${r.isPending?"animate-spin":""}`}),r.isPending?"Creating...":"Reorder"]}),e.jsxs(d,{variant:"outline",className:"flex-1",children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),"Track Shipment"]})]})})]})})]})}const Ce=[{value:"pending",label:"Pending"},{value:"confirmed",label:"Confirmed"},{value:"in_production",label:"In Production"},{value:"quality_check",label:"Quality Check"},{value:"ready_to_ship",label:"Ready to Ship"},{value:"shipped",label:"Shipped"},{value:"delivered",label:"Delivered"},{value:"cancelled",label:"Cancelled"}],Se={low:"secondary",normal:"secondary",high:"warning",urgent:"destructive"};function ke({orders:s,onViewOrder:l,onReorder:c,isReordering:r}){return e.jsx("div",{className:"rounded-lg border bg-card",children:e.jsxs(ae,{children:[e.jsx(te,{children:e.jsxs(P,{children:[e.jsx(o,{children:"Order"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Priority"}),e.jsx(o,{className:"hidden md:table-cell",children:"Items"}),e.jsx(o,{className:"hidden lg:table-cell",children:"Date"}),e.jsx(o,{className:"text-right",children:"Total"}),e.jsx(o,{className:"w-[50px]"})]})}),e.jsx(le,{children:s.map(t=>e.jsxs(P,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>l(t),children:[e.jsx(m,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.orderNumber}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.lineItems.length," item",t.lineItems.length!==1?"s":""]})]})}),e.jsx(m,{children:e.jsx(F,{status:t.status})}),e.jsx(m,{children:e.jsx(re,{variant:Se[t.priority],children:t.priority})}),e.jsx(m,{className:"hidden md:table-cell",children:e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.lineItems.slice(0,2).map(a=>a.productName).join(", "),t.lineItems.length>2&&` +${t.lineItems.length-2}`]})}),e.jsx(m,{className:"hidden lg:table-cell",children:e.jsx("span",{className:"text-sm",children:v(t.createdAt)})}),e.jsx(m,{className:"text-right font-medium",children:x(t.total)}),e.jsx(m,{children:e.jsxs(ie,{children:[e.jsx(ne,{asChild:!0,onClick:a=>a.stopPropagation(),children:e.jsx(d,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsxs(ce,{align:"end",children:[e.jsxs(N,{onClick:a=>{a.stopPropagation(),l(t)},children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsxs(N,{onClick:a=>{a.stopPropagation(),c(t.id)},disabled:r,children:[e.jsx(D,{className:de("mr-2 h-4 w-4",r&&"animate-spin")}),"Reorder"]}),e.jsxs(N,{onClick:a=>a.stopPropagation(),children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Download Invoice"]})]})]})})]},t.id))})]})})}function Re(){const[s,l]=h.useState(1),[c]=h.useState(10),[r,t]=h.useState(""),[a,j]=h.useState("all"),[E,b]=h.useState(null),[R,w]=h.useState(!1),C=A(),{data:i,isLoading:q,error:z,refetch:Q}=be({page:s,pageSize:c,filters:{search:r||void 0,status:a!=="all"?[a]:void 0}}),B=n=>{b(n),w(!0)},K=n=>{C.mutate(n)},L=()=>{w(!1),setTimeout(()=>b(null),300)};return z?e.jsxs("div",{children:[e.jsx(O,{title:"Orders",subtitle:"Manage and track your packaging orders"}),e.jsx(me,{title:"Failed to load orders",message:"We couldn't load your orders. Please try again.",onRetry:()=>Q()})]}):e.jsxs("div",{children:[e.jsx(O,{title:"Orders",subtitle:"Manage and track your packaging orders",actions:e.jsxs(d,{children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"New Order"]})}),e.jsx(S,{className:"mb-6",children:e.jsxs("div",{className:"p-4 flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(U,{placeholder:"Search orders...",value:r,onChange:n=>{t(n.target.value),l(1)},className:"pl-9"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(W,{value:a,onValueChange:n=>{j(n),l(1)},children:[e.jsxs(Y,{className:"w-[180px]",children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),e.jsx(J,{placeholder:"Status"})]}),e.jsxs(X,{children:[e.jsx(k,{value:"all",children:"All Statuses"}),Ce.map(n=>e.jsx(k,{value:n.value,children:n.label},n.value))]})]})})]})}),q?e.jsx(Z,{variant:"table",count:5}):(i==null?void 0:i.data.length)===0?e.jsx(S,{children:e.jsx(xe,{variant:"orders",title:"No orders found",description:r||a!=="all"?"Try adjusting your filters to find what you're looking for.":"Get started by creating your first order.",action:r||a!=="all"?{label:"Clear Filters",onClick:()=>{t(""),j("all")}}:{label:"Create Order",onClick:()=>{}}})}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{orders:(i==null?void 0:i.data)||[],onViewOrder:B,onReorder:K,isReordering:C.isPending}),i&&i.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(s-1)*c+1," to ",Math.min(s*c,i.total)," of ",i.total," orders"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>l(s-1),disabled:s===1,children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,i.totalPages)},(n,V)=>{const p=V+1;return e.jsx(d,{variant:p===s?"default":"outline",size:"sm",className:"w-8",onClick:()=>l(p),children:p},p)})}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>l(s+1),disabled:s===i.totalPages,children:["Next",e.jsx(se,{className:"h-4 w-4 ml-1"})]})]})]})]}),e.jsx(we,{order:E,open:R,onClose:L})]})}export{Re as OrdersPage,Ee as useCancelOrderMutation,Ae as useOrderQuery,be as useOrdersQuery,A as useReorderMutation};
